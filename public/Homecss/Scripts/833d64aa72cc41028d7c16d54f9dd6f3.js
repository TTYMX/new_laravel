fml.define("common/ptpParams",[],function(i,e){"use strict";window.PTP_PARAMS={EnableLogMoGuJs:!1,uuid:"__mgjuuid",uid:"__ud_",platform:function(){var i=navigator.userAgent;return i.indexOf("meilishuo4android")!=-1||i.indexOf("meilishuo android")!=-1?"24":i.indexOf("meilishuo4ios")!=-1||i.indexOf("Meilishuo iPhone")!=-1?"23":/iphone|android|ipad/i.test(i)?"34":"33"},hrefRe:/http[s]?:\/\/\w+\.(meilishuo|mogujie)\.com([\/]|\/.*|)$/,mgjRe:/(meilishuo|mls):\/\//,isNativeRe:/(meilishuo|mls|mogujie)/i,nativeLog:{}}});;fml.define("common/user",[],function(t,o){"use strict";function s(){return $.ajax({url:"http://portal.meilishuo.com/api/profile/baseinfo",dataType:"jsonp"}).always(function(t){var o,s,n="";t&&t.status&&1001===t.status.code?(o=t.result,s=!1):(s=!0,n=t.status.msg),a={userInfo:o,isError:s,errMsg:n}})}var n,a;Meilishuo.global.getUserInfo=function(t){t&&"function"==typeof t||(t=function(){}),n?n.always(t):(n=s()).always(function(){t(a)})}});;fml.define("lib/trace",[],function(){(function(){"use strict";function n(){for(var n=arguments,e=arguments[0],t=arguments.length,r=1;r<t;r++){var i=n[r];for(var o in i)i.hasOwnProperty(o)&&(e[o]=i[o])}return e}function e(n){return"function"!=typeof n?n:n()}function t(n){n=n||location.href;var t=e(T.customUrl);return t?t=t.split("https://").join("").split("http://").join(""):("string"==typeof n&&(n=n.split("?")[0].split("#")[0].split("https://").join("").split("http://").join(""),"/"===n.charAt(n.length-1)&&(n=n.substr(0,n.length-1))),n)}function r(n,e,t){if("function"==typeof Array.prototype.map)return n.map(e,t);for(var r=new Array(n.length),i=0;i<n.length;i++)r[i]=e.call(t,n[i]);return r}function i(n,e,t){if("function"==typeof Array.prototype.filter)return n.filter(e,t);for(var r=[],i=0;i<n.length;i++)e.call(t,n[i])&&r.push(n[i]);return r}function o(n,e){if("function"==typeof Array.prototype.indexOf)return n.indexOf(e);for(var t=0;t<n.length;t++)if(n[t]===e)return t;return-1}function a(){var n=navigator.userAgent.toLowerCase();return/iphone|android|ipad/i.test(n)?"h5":"pc"}function s(){var n,e,t=navigator.userAgent,r="其它",i=r,o="",a="";return(n=t.indexOf("Opera"))!==-1&&(i="Opera",o=t.substring(n+6),(n=t.indexOf("Version"))!==-1&&(o=t.substring(n+8))),(n=t.indexOf("OPR"))!==-1?(i="Opera",o=t.substring(n+4)):t.indexOf("MicroMessenger")!==-1?i="Wechat":t.indexOf("QQ")!==-1?i="QQ":(n=t.indexOf("MSIE"))!==-1?(i="IE",o=t.substring(n+5)):(n=t.indexOf("Chrome"))!==-1?(i="Chrome",o=t.substring(n+7)):(n=t.indexOf("Firefox"))!==-1?(i="Firefox",o=t.substring(n+8)):t.indexOf("Trident/")!==-1?(i="IE",o=t.substring(t.indexOf("rv:")+3)):(n=t.indexOf("Safari"))===-1&&t.indexOf("iPhone")===-1||(i="Safari",o=t.substring(n+7),(n=t.indexOf("Version"))!==-1&&(o=t.substring(n+8))),(e=o.indexOf(";"))!==-1&&(o=o.substring(0,e)),(e=o.indexOf(" "))!==-1&&(o=o.substring(0,e)),(e=o.indexOf(")"))!==-1&&(o=o.substring(0,e)),o&&(a=parseInt(""+o,10),isNaN(a)&&(o=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10))),a?i+"_"+a:i+"_unknown"}function d(){var n="其它",e=n,t=navigator.userAgent,r=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var i in r){var o=r[i];if(o.r.test(t)){e=o.s;break}}var a=n;switch(/Windows/.test(e)&&(a=/Windows (.*)/.exec(e)[1],e="Windows"),e){case"Mac OS X":a="";break;case"Android":var s=/Android( |\/)([\.\_\d]+)/.exec(t);if(s&&s.length>0){var d=(s[2]||"").split(".").slice(0,2);a=d.join(".")}break;case"iOS":a=/OS (\d+)_(\d+)_?(\d+)?/.exec(t),a&&a.length>0&&(a=a[1]+"."+a[2])}return e===n?e:e+a}function f(){var n,e,t=window.screen,r="";return t&&t.width&&(n=t.width?t.width:"",e=t.height?t.height:"",r+=""+n+"x"+e),r}function c(){var n=(window.devicePixelRatio?window.devicePixelRatio:1)-0;return n.toFixed(1)}function u(){return{platform:a(),screen:f(),os:d(),browser:s(),devicePixelRatio:c()}}function p(){var n=window.performance&&window.performance.timing;if(!n)return{};var t=window[T.blankTime];t||(t=n.domContentLoadedEventStart);var r={dns:n.domainLookupEnd-n.domainLookupStart,tcp:n.connectEnd-n.connectStart,request:n.responseStart-n.requestStart,response:n.responseEnd-n.responseStart,domContentLoad:n.domContentLoadedEventEnd-n.navigationStart,blankTime:t-n.navigationStart,readyTime:n.domInteractive-n.navigationStart,onloadTime:n.loadEventEnd-n.navigationStart,extraTime:e(T.getExtraTime)||0};return r}function l(){var e=u(),r=p();r.formatUrl=t();var i=window.logger;i&&i.log&&i.log("016000001",n({},e,r))}function w(n,e,t,r){for(var i=!0,o=0;o<I.length;o++){var a=I[o]||{};if(a.msg===n&&a.file===e&&a.line===t&&a.col===r){i=!1;break}}return i}function v(n,e,r,i,o){if(w(n,e,r,i)){var a="";if(o){if(o.hasReported)return;a=o.stack||""}I.push({msg:n,file:e,line:r,col:i});var s=window.logger;s&&s.log&&s.log("016000011",{type:0,msg:n,file:e,line:r,col:i,stack:a,ua:navigator.userAgent,formatUrl:t()})}}function g(n){if(!n)return null;var e={};if("object"==typeof n?(e.msg=n.message||"",e.stack=n.stack||""):e.msg=n,e.ua=navigator.userAgent,e.type=1,"object"==typeof n&&n.stack)try{e.msg=k.parse(n)}catch(t){}return e}function m(){var n=navigator.userAgent.toLowerCase();return n.indexOf("msie")!==-1&&parseInt(n.split("msie")[1],10)}function h(n){"string"==typeof n&&(n=new Error(n)),n.hasReported||(n.hasReported=!0,A.sendMsg(n))}function y(n){return"function"!=typeof n.apply?n:function(){try{return n.apply(this,arguments)}catch(e){throw h(e),console&&console.warn&&console.warn(e),e}}}function O(n){return n&&"function"==typeof n.apply?function(){for(var e,t=arguments,r=[],i=0,o=arguments.length;i<o;i++)e=t[i],"function"==typeof e&&(e=y(t[i])),r.push(e);return n.apply(this,r)}:n}function x(n,e){for(var t in e)n[t]=e[t]}function W(){var n=window.$;if(n&&(n===window.jQuery||n===window.Zepto)){var e=n.fn.ready;n.fn.ready=O(e);var t=n.ajax;"function"==typeof t&&"function"==typeof t.apply&&(n.ajax=function(e,r){var i=null;return"undefined"==typeof r&&"object"==typeof e?i=e:"object"==typeof r&&(i=r),i&&("function"==typeof i.success&&(i.success=y(i.success)),"function"==typeof i.complete&&(i.complete=y(i.complete))),t.apply(n,arguments)});var r=n.Deferred;"function"==typeof r&&"function"==typeof r.apply&&(n.Deferred=function(){var n=r.apply(this,arguments),e=n.resolveWith;return n.resolveWith=y(e),n})}}function S(){var n=window.require,e=window.define;e&&e.amd&&n&&(window.require=O(n),x(window.require,n),window.define=O(e),x(window.define,e))}function E(){var n=window.setTimeout;window.setTimeout=function(e,t){switch("function"==typeof e&&(e=y(e)),arguments.length){case 0:return n();case 1:return n(e);default:return n(e,t)}};var e=window.setInterval;window.setInterval=O(e);var t=window.requestAnimationFrame;"function"==typeof t&&(window.requestAnimationFrame=O(t));var r=window.Promise;if("undefined"!=typeof r){var i=r.prototype.then;window.Promise.prototype.then=O(i)}if(window.EventTarget&&window.EventTarget.prototype.addEventListener){var o=window.EventTarget.prototype.addEventListener;window.EventTarget.prototype.addEventListener=function(n,e,t){return e&&"function"==typeof e.handleEvent?(e.handleEvent=y(e.handleEvent),o.call(this,n,e,t)):(e.___wrapper||(e.___wrapper=y(e)),o.call(this,n,e.___wrapper,t))};var a=window.EventTarget.prototype.removeEventListener;window.EventTarget.prototype.removeEventListener=function(n,e,t){return e?a.call(this,n,e.___wrapper||e,t):a.call(this,n,e,t)}}}var T={customUrl:function(){},getExtraTime:function(){return 0},blankTime:"__trace__headendt"},b=/^\s*at .*(\S+\:\d+|\(native\))/m,N=/^(eval@)?(\[native code\])?$/,_={parse:function(n){return n.stack&&n.stack.match(b)?this.parseV8OrIE(n):n.stack?this.parseFFOrSafari(n):[]},extractLocation:function(n){if(n.indexOf(":")===-1)return[n];var e=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/,t=e.exec(n.replace(/[\(\)]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(n){var e=i(n.stack.split("\n"),function(n){return!!n.match(b)},this);return r(e,function(n){n.indexOf("(eval ")>-1&&(n=n.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var e=n.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),t=this.extractLocation(e.pop()),r=e.join(" ")||void 0,i=o(["eval","<anonymous>"],t[0])>-1?void 0:t[0];return{functionName:r,filename:i,row:t[1],column:t[2],line:n}},this)},parseFFOrSafari:function(n){var e=i(n.stack.split("\n"),function(n){return!n.match(N)},this);return r(e,function(n){if(n.indexOf(" > eval")>-1&&(n=n.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),n.indexOf("@")===-1&&n.indexOf(":")===-1)return{functionName:n};var e=n.split("@"),t=this.extractLocation(e.pop()),r=e.join("@")||void 0;return{functionName:r,filename:t[0],row:t[1],column:t[2],line:n}},this)}},k={ErrorStackParser:_,parse:function(n){var e=_.parse(n);if(!e||e.length<=0)return n.message;var t=e[0],r=[];if(t.filename){var i=t.filename;i.lastIndexOf("/")>-1&&(i=t.filename.slice(t.filename.lastIndexOf("/"))),r.push(i)}return t.functionName&&r.push("@"+t.functionName),t.row&&r.push(" "+t.row),n.message+" - "+r.join("")},normalize:function(n){var e=_.parse(n);return e}},I=[],A={init:function(){var n=setInterval(function(){var e=window.performance&&window.performance.timing;e&&0===e.loadEventEnd||(clearInterval(n),setTimeout(function(){l()},10))},300);window.onerror=v},sendMsg:function(e){var r=g(e);if(r){n(r,{formatUrl:t()});var i=window.logger;i&&i.log&&i.log("016000011",r)}}},M={init:function(){m()&&m()<9||(W(),S(),E())}};window._trace&&console&&console.warn&&console.warn("WARNING: you already import trace"),"undefined"==typeof window.console&&(window.console={log:function(){},warn:function(){}}),A.init(),M.init();var P=(window._trace={send:function(){},sendImmediately:function(){},version:"1.1.3",config:T,sendMsg:A.sendMsg},{});return P})()});;fml.define("lib/logger",["common/ptpParams"],function(e,t){"use strict";e("common/ptpParams"),function(e){function n(){this.arr="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",this.arrLen=this.arr.length}function r(){var e=g.getPtpInfoAndExtra(),t=f.getValue(l.pEventId);v.logData("p",t,e)}function o(){if(i.info.isNative){var e=g.getPtpCnt();v.logAppPevent(e)}else m?r():f.listenTo("LoggerReady",function(){r()})}if(!e.logger){var i=e.logger={};i.version="0.1.17",i._xcore=!1;var a=navigator.userAgent.toLowerCase().indexOf("xcore")>-1;a&&window.loader&&window.loader.script&&(i._xcore=!0),"undefined"==typeof console&&(window.console={log:function(){}});var u="**logger.js---打点出错:";!function(){function e(){if(!r){r=!0;for(var e=0;e<n.length;e++)n[e].fn.call(window,n[e].ctx);n=[]}}function t(){"complete"===document.readyState&&e()}var n=[],r=!1,o=!1;i._xcore&&(r=!0),i.ready=function(i,a){return r?void setTimeout(function(){i(a)},1):(n.push({fn:i,ctx:a}),void("complete"===document.readyState||!document.attachEvent&&"interactive"===document.readyState?setTimeout(e,1):o||(document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):(document.attachEvent("onreadystatechange",t),window.attachEvent("onload",e)),o=!0)))}}(),function(){var e=window.jQuery||window.Zepto,t=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]==t)return n+1;return-1},n={getA:function(e){var t=e;if("A"==t.tagName)return e;for(;t.parentNode;)if(t=t.parentNode,"A"==t.tagName)return t},getParentByClass:function(t,n){if(t){if(e)return $(t).parents("."+n);for(var r,o=t;o.parentNode;)if(o=o.parentNode,r=o.className&&o.className.indexOf(n)!=-1)return o}},getParents:function(t,n){if(t){if(n=n||"",e)return n="["+n+"]",$(t).parents(n)[0];for(var r,o=t;o.parentNode;)if(o=o.parentNode,r=o.getAttribute&&o.getAttribute(n))return o}},getIndex:function(n,r,o){if(!n||!r||!o)return 0;if(e)return $("["+n+'="'+r+'"]').index($(o))+1;if(document.querySelectorAll){var i=document.querySelectorAll("["+n+'="'+r+'"]');return t(i,o)}return 1},getElemIndex:function(n,r,o){if(!n||!r||!o)return 0;if(e)return $(n).find(r).index($(o))+1;if(n.querySelectorAll){var i=n.querySelectorAll(r);return t(i,o)}return 1},is:function(e,t){return!(!e||!t)&&(e.length&&(e=e[0]),e.nodeName.toLowerCase()===t.toLowerCase()||void 0)}};i.jq=n}();var c=1001,d={},f={getIEVersion:function(){var e,t=-1,n=navigator.userAgent;return"Microsoft Internet Explorer"==navigator.appName?(e=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==e.exec(n)&&(t=parseFloat(RegExp.$1))):"Netscape"==navigator.appName&&(e=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!==e.exec(n)&&(t=parseFloat(RegExp.$1))),t},stringify:function(e){if("undefined"!=typeof JSON)return JSON.stringify(e);var t=typeof e;if("object"!=t||null===e)return"string"==t&&(e='"'+e+'"'),String(e);var n,r,o=[],i=e&&e.constructor==Array;for(n in e)r=e[n],t=typeof r,e.hasOwnProperty(n)&&("string"==t?r='"'+r+'"':"object"==t&&null!==r&&(r=f.stringify(r)),o.push((i?"":'"'+n+'":')+String(r)));return(i?"[":"{")+String(o)+(i?"]":"}")},isArray:function(e){return"[object Array]"==Object.prototype.toString.call(e)},getCookieInArray:function(e){for(var t=0,n=e.length;t<n;t++){var r=f.getCookie(e[t]);if(r)return r}return""},getCookieOrFunc:function(e){return"function"==typeof e?f.getValue(e):f.getCookie(e)},getCookie:function(e){if(f.isArray(e))return f.getCookieInArray(e);var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!==t?decodeURIComponent(t[2]):""},getQuery:function(e,t){void 0===t&&(t=location.search),t=t.split("#")[0];var n="(^|&|\\?)"+e+"=([^&]*)(&|$)",r=new RegExp(n,"i"),o=t.substr(1).match(r);return null!==o?decodeURIComponent(o[2]):""},setQuery:function(e,t,n){var r=new RegExp("([?&])"+t+"=.*?(&|$)","i"),o=e.indexOf("?")!==-1?"&":"?";return e.match(r)?e.replace(r,"$1"+t+"="+n+"$2"):e+o+t+"="+n},getTime:function(){return parseInt((new Date).getTime()/1e3)},registerEvent:function(e,t,n){window.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},extend:function(){for(var e=arguments,t=arguments[0],n=1;n<e.length;n++){var r=e[n];for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])}return t},getValue:function(e){if(e){if("function"==typeof e)try{var t=Array.prototype.slice.call(arguments,1);return e.apply(null,t)}catch(n){return console.log(u+n),""}return e}},loadScript:function(e,t){if(window["callback_"+c]=function(e){t&&t(e)},e+="?callback=callback_"+c,c+=1,i._xcore)window.loader.script(e);else{var n=document.createElement("script");n.src=e;var r=document.getElementsByTagName("head")[0];r&&r.appendChild(n)}},listenTo:function(e,t){d[e]||(d[e]=[]),d[e].push(t)},fire:function(e){var t=d[e];if(t&&t.length){for(var n=0,r=t.length;n<r;n++)t[n].call();d[e]=[]}},hasKey:function(e){if(!e)return!1;for(var t in e)if(e.hasOwnProperty(t))return!0;return!1}};i.util=f;var p="https:"===location.protocol?"https:":"http:",s="mogujie";location.host.indexOf("meilishuo")!=-1&&(s="meilishuo"),i.config={LogUrl:p+"//log.juangua.com/log.php",LogMoGuJsUrl:p+"//log.juangua.com/mogu.js",CookieUrl:p+"//portal."+s+".com/api/util/getUuid",shouldRequestCookie:function(){if(location.protocol.indexOf("file:")!=-1)return!1;var e=i.util.getCookieOrFunc(i.config.uuid);return!e},uuid:["__mgjuuid","__xduuid"],uid:"__ud_",sfrom:"from_site",cpsinfo:"__cpsinfo",ptp_cnt_a:"",ptp_cnt_b:"",ptp_cnt_c_d:"",platform:function(){var e=navigator.userAgent.toLowerCase();if(/qq\/([\d\.]+)/.test(e))return 48},pEventId:"1001",isMobileRe:/iphone|android|ipad/i,ptpRe:/[a-z0-9]+\.[a-z0-9]+\.[a-z0-9]+\.[a-z0-9]+\.[a-z0-9]+/i,hrefRe:/http[s]?:\/\/\w+\.(mogujie|xiaodian|uniny)\.com([\/]|\/.*|)$/,mgjRe:/mgj:\/\//,mtRe:/\?.*[&]?mt=([^\.]+)\.([^\.]+)\.([^\.&#]+)/,chasing:["f","f2","mlf"],urlExtend:["acm"],urlExtendFn:function(e){},extra:{},isNativeRe:/mogujie(?!nonative)/i,nativeLog:{}},n.prototype={rand:function(e){var t,n="";for(t=0;e>t;t++)n+=this.arr.charAt(Math.random()*this.arrLen);return n},pageHash:function(e){var t=5381,n=e.length-1;if("string"==typeof e)for(;n>-1;n--)t+=(t<<5)+e.charCodeAt(n);else for(;n>-1;n--)t+=(t<<5)+e[n];var r=2147483647&t,o="";do o+=this.arr.charAt(61&r);while(r>>=6);return o}},function(){var e=i.config,t=navigator.userAgent.toLocaleLowerCase();i.info={isApp:e.isNativeRe.test(t),isNative:e.isNativeRe.test(t),isMobile:e.isMobileRe.test(t),isIos:t.indexOf("iphone")>-1,isAndroid:t.indexOf("android")>-1,isXd:location.href.indexOf(".xiaodian.")>-1}}(),function(){function e(){var e="1";return g.isMobile&&(e="m1"),g.isIos&&g.isNative?e="am0":g.isAndroid&&g.isNative&&(e="am1"),e}function t(){var e=f.getValue(s.ptp_cnt_b);if(e)return e;var t="",n=location.href.split("?")[0];return t=v.pageHash(n)}function r(){var e=f.getCookieOrFunc(s.cpsinfo);return e?e=e.replace("-",","):""}function o(){var e=f.getValue(s.platform);return e?e:g.isMobile?32:31}function a(e){if(e){var t=f.getValue(s.urlExtendFn,e);return f.hasKey(t)?t:void 0}}function u(e){if(e){e.length&&(e=e[0]);var t=f.getValue(s.ptp_cnt_c_d,e);if(t)return t;var n=e.getAttribute("data-ptp-customc");if(n)return{c:n,d:l.getIndex("data-ptp-customc",n,e)};if(e=l.getParents(e,"data-ptp-customc"))return n=e.getAttribute("data-ptp-customc"),n?{c:n,d:l.getIndex("data-ptp-customc",n,e)}:void 0}}function c(){return window.PTP_PARAMS&&f.extend(s,PTP_PARAMS),{time:f.getTime(),sfrom:f.getCookieOrFunc(s.sfrom),uuid:f.getCookieOrFunc(s.uuid),uid:f.getCookieOrFunc(s.uid),cpsinfo:r(),refer:location.href,rerefer:document.referrer,ptp_url:f.getQuery("ptp",location.search),ptp_ref:f.getQuery("ptp",document.referrer),_notNative:!g.isNative}}function d(){h.a=e(),h.b=t(),h.c=0,h.d=0}var p,s=i.config,g=i.info,l=i.jq,v=new n,m=c(),h={a:e(),b:t(),c:0,d:0,e:s.ptp_cnt_e?s.ptp_cnt_e:v.rand(5)};i.ptp=p={getPtpByType:function(e,t){var n=o(),r=[m.time,0,"p/e",n,i.version,"1001",m.uuid,m.uid,m.refer,m.rerefer];return"p"==e?(t=t||"1001",r[2]="p",r[5]=t,r):"e"==e?(t=t||"50001",r[2]="e",r[5]=t,r):void 0},getPtpCnt:function(e,t){return e||(e=h.c),t||(t=h.d),[h.a,h.b,e,t,h.e].join(".")},getPtpInfo:function(){var e={};return f.extend(e,m,{ptp_cnt:p.getPtpCnt()})},getPtpInfoAndExtra:function(){var e=p.getPtpInfo(),t={};if(s.extra)for(var n in s.extra)s.extra.hasOwnProperty(n)&&(t[n]=f.getValue(s.extra[n]));return f.extend(e,t)},createPtpCnt:function(e){var t=u(e),n=0,r=0;if(t)return p.getPtpCnt(t.c,t.d);var o=l.getParents(e,"data-ptp"),i=l.getParentByClass(e,"data-ptp-item");return o&&(n=o.getAttribute("data-ptp"),r=i?l.getElemIndex(o,".data-ptp-item",i):l.getElemIndex(o,"a",e)),r||(r=0),p.getPtpCnt(n,r)},makeUrl:function(e,t,n){var r=e.match(/(#.+)$/);return e=e.replace(/(#.+)$/,""),e=f.setQuery(e,"ptp",t),e=p.getChasingParams(e),e=p.getExtendParams(n,e),r&&(e+=r[1]),e},getChasingParams:function(e){void 0===e&&(e="");var t=e;if(!s.chasing)return t;s.chasing.length||(s.chasing=[s.chasing]);for(var n,r,o=0,i=s.chasing.length;o<i;o++)n=s.chasing[o],r=f.getQuery(n),r&&(t=f.setQuery(t,n,r));for(var a=location.search.split("#")[0],u=/[\?&](_f_[^=]+)=([^&]+)/g,c=u.exec(a);c&&3==c.length;)t=f.setQuery(t,c[1],c[2]),c=u.exec(a);return t},getExtendParams:function(e,t){var n=t;if(!e||!l.is(e,"a"))return n;var r=a(e);if(r)for(var o in r)r.hasOwnProperty(o)&&(n=f.setQuery(n,o,r[o]));else{e.length&&(e=e[0]);for(var i=s.urlExtend||[],u=0,c=i.length;u<c;u++){var d=i[u],p=e.getAttribute("data-ext-"+d);p&&(n=f.setQuery(n,d,p))}}return n},refreshPtp:function(){m=c(),d()},refreshE:function(){h&&(h.e=v.rand(5))},refreshCookie:function(){m&&(m.sfrom=f.getCookieOrFunc(s.sfrom),m.uuid=f.getCookieOrFunc(s.uuid),m.uid=f.getCookieOrFunc(s.uid),m.cpsinfo=r())}}}(),function(){var e=i.info,t=i.ptp,n=i.config,r=0,o=function(e,t){t=t||{};var n=[];for(var r in t){var o=t[r];o||(o=""),o=encodeURIComponent(o),n.push(r+"="+o)}n=n.join("&"),e=e.indexOf("?")>-1?e+"&"+n:e+"?"+n;var i=new Image;i.src=e},a=function(e,t){t=t||{};var n,o=r++;try{n=document.createElement('<iframe name="'+o+'">')}catch(i){n=document.createElement("iframe"),n.setAttribute("name",o)}try{n.style.display="none",document.body.appendChild(n),n.contentWindow.name=o;var a=document.createElement("form");a.setAttribute("method","POST"),a.setAttribute("action",e),a.setAttribute("target",o);for(var c in t)if(t.hasOwnProperty(c)){var d=document.createElement("input");d.setAttribute("type","hidden"),d.setAttribute("name",c),d.setAttribute("value",t[c]),a.appendChild(d)}document.body.appendChild(a),a.submit(),f.registerEvent(n,"load",function(){try{document.body.removeChild(a),document.body.removeChild(n)}catch(e){}})}catch(i){console.log(u+i)}},c={sendLog:function(e,t,n){var r=f.getIEVersion(),i=r!=-1&&r<=8;i&&!n?a(e,t):o(e,t)},sendAppLog:function(e,t){return e+="",n.nativeLog&&n.nativeLog.logE?n.nativeLog.logE(e,t):void(window.hdp&&window.hdp["do"]?hdp["do"]("mgj.tracker.sendEvent",e,t):document.addEventListener("deviceready",function(){window.mgj&&mgj.tracker&&mgj.tracker.sendEvent&&mgj.tracker.sendEvent(e,t)},!1))},logAppPevent:function(e){return n.nativeLog&&n.nativeLog.logP?n.nativeLog.logP(e):void(window.hdp&&window.hdp["do"]?hdp["do"]("mgj.pevent",e).then(function(){},function(e){console.log("pevent:"+e)}):document.addEventListener("deviceready",function(){window.mgj&&mgj.pevent&&mgj.pevent(function(){},null,e)},!1))},logData:function(r,o,i){var a=t.getPtpByType(r,o);a.push(f.stringify(i)),e.isNative?c.sendAppLog(o,i):c.sendLog(n.LogUrl,{v:1,data:a.join("\t")})}};i.send=c}(),function(){function e(e){var t=e.href;if(!(t.indexOf("mogujie.com/mtalk/")>-1)&&(r.hrefRe.test(t)||r.mgjRe.test(t))){var n=e.getAttribute("data-ptp-cache-id");t=e.getAttribute("href"),n&&r.ptpRe.test(n)||(n=o.createPtpCnt(e),e.setAttribute("data-ptp-cache-id",n)),e.href=o.makeUrl(t,n,e)}}function t(e){if(e.getAttribute){var t=e.getAttribute("href");if(null==t||0===t.indexOf("#"))return!1}return!0}function n(n){var r=n||window.event,o=r.target||r.srcElement,i=a.getA(o),u="AREA"===o.nodeName?o:null;u&&(i=u),i&&(i.href&&i.href.indexOf("javascript:")>-1||t(i)&&e(i))}var r=i.config,o=i.ptp,a=i.jq;if(!i._xcore){var u="tap"in document.createElement("div")?"tap":"mousedown";f.registerEvent(document,u,n),f.registerEvent(document,"touchstart",n)}}();var g=i.ptp,l=i.config,v=i.send,m=!l.shouldRequestCookie();m||f.loadScript(l.CookieUrl,function(){m=!0,i.ptp.refreshCookie(),f.fire("LoggerReady")}),i.ready(function(){i.ptp.refreshPtp(),o()}),i.refreshPevent=function(){i.ready(function(){i.ptp.refreshPtp(),i.ptp.refreshE(),o()})},i.log=function(e,t){void 0!==e&&(t=t||{},i.ready(function(){var n=g.getPtpInfoAndExtra();m?i.send.logData("e",e,f.extend({},n,t)):f.listenTo("LoggerReady",function(){var n=g.getPtpInfoAndExtra();i.send.logData("e",e,f.extend({},n,t))}),window.MtaH5&&MtaH5.clickStat&&MtaH5.clickStat(e,t)}))},i.generatePtpParams=function(e,t){if(void 0!==e){var n="";return n=t?g.createPtpCnt(t):g.getPtpCnt(),g.makeUrl(e,n,t)}},"undefined"!=typeof module&&"object"==typeof t?module.exports=i:"function"==typeof define&&(define.amd||define.cmd)&&define("logger",function(){return i})}}(window)});;fml.define("common/biu",[],function(o,t){"use strict";var n=function(){function o(){n.css("height",$(document).height()+"px")}function t(o){var t={url:location.href,refer:document.referrer,keyword:o};logger.log("000815009",t)}var n=$(".biu-sidebar"),u=$(".biu-download"),e=$(".mls-qrcode");o(),$(window).resize(function(){o()}),u.hover(function(){e.css("display","block")},function(){e.css("display","none")}),$(window).scroll(function(){document.body.scrollTop?document.body.scrollTop>0?$(".biu-go2top").css("display","block"):$(".biu-go2top").css("display","none"):document.documentElement.scrollTop&&document.documentElement.scrollTop>0?$(".biu-go2top").css("display","block"):$(".biu-go2top").css("display","none")}),$(".biu-go2top").on("click",function(){window.scrollTo(0,0)}),$(".biu-cart").on("click",function(){var o="购物车";t(o)}),$(".biu-coupon").on("click",function(){var o="优惠券";t(o)}),$(".biu-mark").on("click",function(){var o="收藏";t(o)}),$(".biu-footprint").on("click",function(){var o="足迹";t(o)}),$.ajax({type:"get",url:"http://cart.meilishuo.com/api/cart/getItemCount?marketType=market_meilishuo",dataType:"jsonp",success:function(o){var t=o||{};1001==t.status.code&&t.result&&t.result.count>0&&(t.result.count>99?$(".biu-cart-num").text("99+"):$(".biu-cart-num").text(t.result.count))},error:function(){console.log("--右侧栏 jsonp请求购物车商品数出错")}}),$.ajax({type:"get",url:"http://promotionnew.meilishuo.com/jsonp/getUnUsedCouponNumber/1?domain=11",dataType:"jsonp",success:function(o){var t=o||{};t.success&&t.data.number>0&&(t.data.number>99?$(".biu-coupon-num").text("99+"):$(".biu-coupon-num").text(t.data.number))},error:function(){console.log("--右侧栏 jsonp请求优惠券数出错")}});var c=$(".biu-login").text(),i=""==c||"0"==c||null==c&&void 0!=c||" "==c;!i&&$.ajax({type:"get",url:"http://webim.meilishuo.com/jsonp/cinfo/1",dataType:"jsonp",success:function(o){var t=o||{};t.success&&t.data>0&&$(".biu-service-num").addClass("biu-service-num-circle")},error:function(o,t){console.log("--右侧栏 jsonp请求客服消息数出错")}}),$(".biu-open-im").on("click",function(){var o=$(".biu-login").text(),n=$(this).data("shopid")||"",u="消息";return t(u),""==o||"0"==o||null==o&&void 0!=o||" "==o?(window.open("http://www.meilishuo.com/user/login"),!1):(window._openIm(n),!1)})};n.prototype.biuAddCart=function(o){$.ajax({type:"get",url:"http://cart.meilishuo.com/api/cart/getItemCount?marketType=market_meilishuo",dataType:"jsonp",jsonp:"biuCartNum",success:function(t){var n=t||{};if(1001==n.status.code&&n.result&&n.result.count>0){var u=n.result.count+o;u>0&&u<100?$(".biu-cart-num").text(u):$(".biu-cart-num").text("99+")}}})};var u=new n;t.biuAddCart=u.biuAddCart});;fml.define("common/nav",[],function(t,a){"use strict";var i=$(".sec_attr .list");$(".nav_list");i.hover(function(){var t=$(this).children(".nav_list");0!=t.length&&(i.removeClass("active"),$(this).addClass("active"),t.show())},function(){i.removeClass("active"),$(this).removeClass("active"),$(this).children(".nav_list").hide()});var e=i.length;i.each(function(t){t==e-1&&$(this).addClass("last")});var n=$(".attr_box");"welcome"==Meilishuo.config.controller?n.css("display","block"):$(".all , .attr_box").hover(function(){n.stop(!0,!0).slideDown()},function(t){t.stopPropagation(),n.find(".nav_list").hide(),n.stop(!0,!0).slideUp()});var s=$(".nav_tab"),l=s.find("a"),o={"/welcome":l.eq(0).html(),"/brand/street":l.eq(1).html(),"/daimaiPCrukou":l.eq(2).html(),"/select":l.eq(3).html()},c="",h=location.pathname;$.each(o,function(t,a){if(0==h.indexOf(t))return c=o[t],!1}),"/"==h&&(c="首页"),s.each(function(){var t=$(this).find("a").html();c==t&&$(this).find("a").addClass("active")})});;fml.define("common/search",[],function(t,e){"use strict";function a(t){t=t.list;for(var e="",a=0;a<t.length;a++){var n=t[a];e+='<a target="_blank" href="http://www.meilishuo.com/search/goods/?page=1&searchKey='+encodeURIComponent(n.word)+'" style="color:'+n.color+'">'+n.word+"</a >"}u.html(e)}function n(t){t&&t.list&&t.list.length&&(t=t.list[0],h.attr({placeholder:t.placehold,"data-placeholder":t.placehold,"data-key":t.word}))}function o(){$.ajax({url:"http://mce.mogucdn.com/jsonp/multiget/3?pids=5604,5571",dataType:"jsonp"}).then(function(t){t.success&&(a(t.data[5571]),n(t.data[5604]))})}function i(t){var e=/(?:&|\?)searchKey=([^&]+)/.exec(location.search);e&&e[1]&&h.val(decodeURI(e[1]));var a=/(?:&|\?)filter=([^&]+)/.exec(location.search);a=a&&a[1],"shop"==a&&c(f.find("span")[1])}function c(t){$(t).is("span")&&(f.find("span").removeClass("active"),$(t).addClass("active"),v=$(t).index(),h.attr("placeholder",0==v?h.attr("data-placeholder"):""))}function s(){if(0==v){var t=$.trim($(this).val());if(t){if(w.lastVal==t)return void p.show();w.lastVal=t,w.cache[v]=w.cache[v]||{};var e=w.cache[v];clearTimeout(w.delayId),w.delayId=setTimeout(function(){e[t]?w.render(e[t]):$.ajax({url:w.url,data:{data:'{"keyword":"'+encodeURIComponent(t)+'"}'},dataType:"jsonp"}).then(function(a){e[t]=a,w.render(e[t])})},w.delayTime)}}}function l(t){var e=$(".active",p).removeClass("active");e.length?"up"==t?(e=e.prev(),e.length||(e=p.find(".item").last())):(e=e.next(),e.length||(e=p.find(".item").first())):e=p.find(".item").first(),e.addClass("active"),h.val(e.attr("data-title"))}function r(t){if(t=0==v?$.trim(t)||$.trim(h.attr("data-key")):$.trim(t)){var e=(encodeURIComponent(t),"http://www.meilishuo.com/search/goods/?page=1&searchKey="+encodeURIComponent(t));0!=v&&(e="http://www.meilishuo.com/search/shop/"+encodeURIComponent(t)+"?filter=shop"),location.href=e}}function d(){i(),o(),f.click(function(t){c(t.target)}),g?h.on("input",function(){s.call(this)}):h.on("propertychange",function(){s.call(this)}),h.on("blur",function(){setTimeout(function(){p.hide()},250)}).on("focus",function(){s.call(this)}).on("keyup",function(t){var e=t.keyCode;if(38==e||40==e){var a=38==e?"up":"down";l(a)}else 13==e&&r(this.value)}),p.on("mouseover",function(t){$(".item",this).removeClass("active"),$(t.target).closest(".item").addClass("active")}).on("click",function(t){var e=$(".active",this).attr("data-title"),a=t.target;r("span"==a.tagName.toLowerCase()?e+" "+$(a).text():e)}),m.on("click",function(){r(h.val())})}var h=$(".search-txt"),u=$(".hotword"),f=$(".search-tab"),p=$(".suggest-box"),m=$(".search-btn"),v=0,g="oninput"in document,w={lastVal:null,delayId:null,cache:{},url:"http://search.mogujie.com/jsonp/searchTipsMLS/1",delayTime:500,render:function(t){if(t&&t.success){for(var e=t.data.tips,a="",n=0;n<e.length;n++){for(var o=e[n].props,i="",c=0;c<o.length;c++)i+="<span>"+o[c].title+"</span>";a+='<div class="item" data-title="'+e[n].title+'">'+e[n].title+'<div class="tags">'+i+"</div></div>"}p.html(a).show()}else p.hide()}};d()});;fml.define("common/topbar",[],function(t,a){"use strict";function s(t){var a=$(".cart-goods"),s={marketType:"market_meilishuo",topNum:5};$.ajax({url:"http://cart.meilishuo.com/api/cart/miniCartList",data:s,dataType:"jsonp"}).then(function(s){if("1001"==s.status.code){var e="",o=s.result.cartItems?s.result.cartItems.length:0,r=Math.min(5,o);if(r>0){$(".cart-wrapper .hidden").addClass("down").removeClass("hidden"),t();for(var c=0;c<r;c++){for(var i=s.result.cartItems[c],n="",l=0,d=i.skuAttributes.length;l<d;l++){var p=i.skuAttributes[l];n+="<span>"+p.key+":"+p.value+"</span>&nbsp;&nbsp;"}e+='<li><a href="http://item.meilishuo.com/detail/'+i.itemIdEsc+'" target="_blank" style="padding: 0; float: left;"><span class="cart-goods-img" style="background: url('+i.imgUrl+') no-repeat; background-size: cover;"></span></a><div class="cart-goods-desc"><p><a href="http://item.meilishuo.com/detail/'+i.itemIdEsc+'" target="_blank" style="padding: 0; float: left;"><span class="cart-goods-title">'+i.title+'</span></a><span class="cart-goods-price">￥'+i.nowprice/100+'</span></p><p class="cart-goods-info"><span class="cart-goods-title">'+n+'</span><em class="del-cart-goods" data-stock="'+i.stockIdEsc+'"></em></p></div></li>'}a.html(e)}}})}function e(){$.ajax({url:"http://cart.meilishuo.com/api/cart/getItemCount",data:{marketType:"market_meilishuo"},dataType:"jsonp"}).then(function(t){var a=t.status,s=t.result.count>99?"99+":t.result.count;a.isLogin&&"1001"==a.code&&0!=s&&($(".cart .hidden").addClass(".down").removeClass(".hidden"),$(".my-cart").append('<span class="cart-num">'+s+"</span>"),$(".cart-account .num").text(s))})}function o(){s(e),$("#com-topbar").on("click",".del-cart-goods",function(){var t=$(this).closest("li"),a=$(this).closest(".down"),s=$(this).data("stock");$.ajax({url:"http://cart.meilishuo.com/api/cart/deleteCart",data:{marketType:"market_meilishuo",stockId:s},dataType:"jsonp"}).then(function(s){t.remove();var e=a.find(".cart-goods li").length;e||a.remove()})})}o()});;fml.define("common/assert",[],function(o,i){"use strict";Meilishuo.global.assert=function(o,i){if(!o)throw Error(i)}});;fml.define("common/polyfill",[],function(n,t){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});for(var e=["webkit","moz"],o=0;o<e.length&&!window.requestAnimationFrame;++o){var r=e[o];window.requestAnimationFrame=window[r+"RequestAnimationFrame"],window.cancelAnimationFrame=window[r+"CancelAnimationFrame"]||window[r+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var i=0;window.requestAnimationFrame=function(n){var t=Date.now(),e=Math.max(i+16,t);return setTimeout(function(){n(i=e)},e-t)},window.cancelAnimationFrame=clearTimeout}Array.prototype.forEach||(Array.prototype.forEach=function(n,t){var e,o;if(null==this)throw new TypeError(" this is null or not defined");var r=Object(this),i=r.length>>>0;if("function"!=typeof n)throw new TypeError(n+" is not a function");for(arguments.length>1&&(e=t),o=0;o<i;){var a;o in r&&(a=r[o],n.call(e,a,o,r)),o++}}),Array.prototype.map||(Array.prototype.map=function(n,t){var e,o,r;if(null==this)throw new TypeError(" this is null or not defined");var i=Object(this),a=i.length>>>0;if("[object Function]"!=Object.prototype.toString.call(n))throw new TypeError(n+" is not a function");for(t&&(e=t),o=new Array(a),r=0;r<a;){var w,c;r in i&&(w=i[r],c=n.call(e,w,r,i),o[r]=c),r++}return o})});;fml.define("core/etic",[],function(e,n){"use strict";function t(e,n,t){if(t&&checkTemplate(e,n),!r[e]){var c=document.getElementById(e).innerHTML;c=c.replace(/[\r\t\n]/g," ").split("<?").join("\t").replace(/((^|\?>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)\?>/g,"',$1,'").split("\t").join("');").split("?>").join(";p.push('").split("\r").join("\\'");try{r[e]=new Function("","var p=[];p.push('"+c+"');return p.join('');")}catch(o){if(console){console.log(o);var l=c.replace(/^[ ]*\'\)|p.push\(\'[ ]*\'\)|p.push\(\'/g,"").replace(/^[ ]*;|;[ ]*$/g,"");console.log(o.message+"   :   "+l);var p=document.createElement("script");p.innerHTML=l;try{new Function("",l)}catch(o){}}}}var i=r[e];if(!n)return i;try{return i.apply(n)}catch(o){console&&(console.log(o),console.log(n))}}var r={};return t});;fml.define("component/shareTmp",["core/etic"],function(e,t){"use strict";var c=e("core/etic");return function(e,t){t=t||Object;try{var r=c(e,t)}catch(n){fml.debug(n)}return r}});;fml.define("common/showLog",[],function(t,n){"use strict";function e(t){return"none"!=t.css("display")&&"hidden"!=t.css("visibility")&&0!=t.css("opacity")&&t.width()&&(t.height()||t.innerHeight&&t.innerHeight())}function s(t){var n=t.offset().top,s=t.height()||t.innerHeight&&t.innerHeight(),a=t.offset().left,i=t.width(),l=$(window).scrollTop(),o=$(window).scrollLeft(),h=$(window).width(),r=$(window).height(),d=n>=l&&n<l+r,g=n+s>l&&n+s<=l+r,c=n<l&&n+s>l+r,u=a>=o&&a<o+h,f=a+i>o&&a+i<=o+h,w=a<o&&a+i>o+h;return e(t)&&(d||g||c)&&(u||f||w)}function a(){if(x.length||_.length||H.length||A.length||y){var t=function(){_&&_.length?(T("0x00000000",{acms:_,indexs:v,type:5}),v=[],_=[]):H&&H.length?(T("0x00000000",{acms:H,indexs:p,type:5}),p=[],H=[]):A&&A.length?(T("70500",{acms:A,indexs:C,iids:b,type:4}),b=[],C=[],A=[]):y?(T(m||70500,y),y=null,m=null):x&&x.length&&(T(m||70500,{acms:x,iids:b,indexs:L}),x=[],b=[],L=[],m=null)};t()}i=!0,window.setTimeout(function(){x.length||_.length||H.length||A.length||y?a():i=!1},1e3)}var i=!1,l="rec-show-log",o="module_row",h="cube-acm-node",r="has-log-mod",d="show-log-item",g="log-custom",c="waiting-log",u="data-log-content",f="data-log-iid",w="data-log-index",m=($("."+l),null),v=[],p=[],C=[],x=[],y=null,_=[],H=[],A=[],b=[],L=[],T=function(t,n){var e=window&&window.logger&&window.logger.log;e&&e(t,n)},j=function(t){var n=t.attr(u),e=n.split(";");$(e).each(function(t,n){var e=n.split("="),s=e[0];s&&(y=y||{},y[s]=y[s]||[],y[s].push(n.replace(s+"=","")))})},k=function(){$("."+o).each(function(t,n){var e=$(n),a=e.attr("data-acm")||"",i=a.split(".");if(a&&s(e)){var l=e.find("."+h+",.anchor"),o=l.length;e.hasClass(r)||(_.push(a+"-mfs_"+o),v.push(t),e.addClass(r)),o&&$(l).each(function(t,n){var e=$(n),l=!e.hasClass(g)&&e.attr("data-log-content")||"",h=e.attr(f)||"";!e.hasClass(r)&&s(e)&&(l&&i[6]?(A.push(l+"-"+i[6]+"-idx_"+t+"-mfs_"+o),C.push(t),h&&b.push(h),e.addClass(r)):(H.push(a+"-idx_"+t+"-mfs_"+o),p.push(t),e.addClass(r)))})}}),$("."+l).each(function(t,n){if(s($(n))||$(n).hasClass(c)){var e=$(n).find("."+d);$(n).removeClass(c),e.length?$(e).each(function(t,e){var a=$(e);if(s(a)||a.hasClass(c)){if(a.removeClass(c),m&&m!==$(n).data("eventid"))return $(n).addClass(c),void a.addClass(c);a.hasClass(g)?j(a):(null!==a.attr(w)&&""!==a.attr(w)&&void 0!==a.attr(w)&&L.push(a.attr(w)),a.attr(u)&&x.push(a.attr(u)),a.attr(f)&&b.push(a.attr(f))),m=$(n).data("eventid"),a.removeClass(g).removeClass(d).removeAttr(u).removeAttr(f).removeAttr(w)}}):$(n).removeClass(l)}}),(x.length||_.length||H.length||A.length||y)&&!i&&a()},q=function(){$(window).scroll(k),$(window).trigger("scroll")};q(),n.log=k});;fml.define("component/exposure",[],function(s,e){"use strict";!function(s){s.fn.scrollLoading=function(e){var c={indexs:"data-list",acms:"data-acms",cparams:"data-cparams",iids:"data-iids",container:window,acm_num:[25,5],eventid:[70004,70001,70015,70011],cpcs:"data-cpcs",best:".cpcs",tf:"toall",callback:s.noop},a=s.extend({},c,e||{}),i=s(a.container);a.cache=[],s(this).each(function(){var e=s(this).attr(a.iids),c=s(this).attr(a.acms),i=s(this).find(a.best).attr(a.cparams),o=s(this).attr(a.indexs),t=s(this).find(a.best).attr(a.cpcs),l={obj:s(this),iids:e,indexs:o,acms:c,cparams:i,cpcs:t};a.cache.push(l)});var o=function(e){s.isFunction(a.callback)&&a.callback.call(e)},t=[],l=[],n=[],f=[],r=[],d=function(){var e=i.outerHeight(),c=i.outerWidth();if(i.get(0)===window)var d=s(window).scrollTop(),p=s(window).scrollLeft();else var d=i.offset().top,p=i.offset().left;s.each(a.cache,function(s,i){var g,h,m,u,v=i.obj,b=i.indexs,w=i.acms,x=i.iids,j=i.cpcs,k=i.cparams,L=a.eventid,_=a.acm_num;a.tf;if(v)if(g=v.offset().top-(d+e),h=v.offset().top+v.height()-d,m=v.offset().left-(p+c),u=v.offset().left+v.width()-p,v.is(":visible")&&g<0&&h>0&&m<0&&u>0&&!v.data("a")){if(b){if(t.push(w),l.push(x),j&&n.push(j),k&&r.push(k),f.push(b),v.data("a",1),r.length>=_[1])if(fml.vars.fcid){if(""!=L[0]){var y={cparams:r,refer:document.referrer,fcid:fml.vars.fcid};console.log(y),logger.log(L[0],y),console.log(L[0]),r=[]}}else if(""!=L[2]){var y={cparams:r,refer:document.referrer};console.log(y),logger.log(L[2],y),console.log(L[2]),r=[]}if(f.length>=_[0])if(fml.vars.fcid){if(""!=L[1]){var y={acms:t,iids:l,cpcs:n,indexs:f};console.log(y),logger.log(L[1],y),console.log(L[1]),t=[],l=[],n=[],f=[]}}else if(""!=L[3]){var y={acms:t,iids:l,cpcs:n,indexs:f};console.log(y),logger.log(L[3],y),console.log(L[3]),t=[],l=[],n=[],f=[]}}}else o(v)})};d(),i.bind("scroll",d)}}(jQuery)});;fml.define("component/waterfall",["common/showLog","component/shareTmp"],function(t,e){"use strict";function i(t){return function(e){return e?e.sort(function(e,i){return t(e,i)||e.left-i.left})[0]:null}}function n(t,e){"string"==typeof e&&(e=e.split(y));try{e&&e.length&&e.forEach(function(e){t=t[e]})}catch(i){J("数据结构错误")}finally{return t}}function o(t,e){var i,n,o=e.helpers,a={};if(t&&t.length){for(i in o)o.hasOwnProperty(i)&&(a[i]=o[i]);n=s,n.call(this,t,e,a),e.onLayoutFinished.call(this,e),e.useOptimise&&(e.hasMoved=!0,this.resetCurTop(),d.triggerHandler(e.touchMoveEventName))}}function a(t){return n(t,this._config._dataName)||[]}function r(t){if(d.height()-g-t<S)return!0}function s(t,e,i){var n,o,a,r,s,c,l,f=this.$el,h=e.tmpl,m=e.colWidth,d=e.useOptimise,p=e.colGapT,g=e.data.frame,x=e.isEqualHeight,v=e._boxHeight,y="",T=null,E=this._cols,L=this._colsHistory,F=L[g],b=this._boxes,k=[],N=0;if(F?E=F.map(function(t){return{min:t.min,max:t.min,left:t.left,frame:g}}):F=E.map(function(t){return{min:t.max,max:t.max,left:t.left,frame:g}}),t.forEach(function(t,n){i.v=t,i.index=n,i.totalIndex=e._totalIndex++,y+=u(h,i)}),f.append(n=_.html(y).children()),o=n.length,!y||!o)return J("没有获取到任何新的 DOM 节点, 请检查模板中是否正确处理了数据");if(n.each(function(t,i){var n,a;i.style.width=m+"px",x?(v||(v=e._boxHeight=i.offsetHeight),n=v):n=i.offsetHeight,T=W(E),W(F),a=T.max+"px",k.push({left:T.left,relativeTopStyle:a,top:T.max,width:m,height:n,index:t,el:i,boxLen:o,frame:g,state:d?e.isFirstFrame?w:G:w}),T.max+=n+p}),e.isFirstFrame=!1,L[g]||(L[g]=E.map(function(t,e){return{min:F[e].max,max:t.max,left:F[e].left,frame:g}})),k.forEach(function(t){var e=t.el;e.style.top=t.relativeTopStyle,e.style.left=t.left+"px",t.baseClass=e.className+=" waterfall-frame-"+g+" "+H,e.className+=" "+t.state}),c=k[0].top,e.isBiWaterfall){if(a=b.length){for(;N<a;){if(l=b[N],l.frame>g){s=N;break}N+=l.boxLen}s="undefined"==typeof s?a:s}else s=0;b.splice.apply(b,[s,0].concat(k))}else!b.length||b[b.length-1].top<=c?this._boxes=b.concat(k):this._boxes=k.concat(b);r=V(E).max,(!this._curTop||r>this._curTop)&&this.$el.height(this._curTop=r),this._cols=E.map(function(t,e){var i=this[e];return{min:t.min<i.min?t.min:i.min,max:t.max>i.max?t.max:i.max,left:t.left,frame:g}},this._cols)}function c(t){return t.checkTimes=1,function e(){setTimeout(function(){t.checkTimes++<B&&(t.initTopOffset=t.$el.offset().top,e())},M*t.checkTimes)}}function l(t){var e,i,n,o=t.colGap,a=4;if(o!==o)return console.error(o+" is not a valid number.");if("number"==typeof o)t.colGapT=t.colGapR=t.colGapB=t.colGapL=o;else{if(e=String(o).split(" "),i=e.length,0==i||i>4)return console.error(o+"'s format is not right.");for(;a--;)if(n=e[a],void 0!==n){if(isNaN(n=+n))return console.error(o+" contains invalid number.");e[a]=n}switch(i){case 1:t.colGapT=t.colGapR=t.colGapB=t.colGapL=e[0];break;case 2:t.colGapT=t.colGapB=e[0],t.colGapR=t.colGapL=e[1];break;case 3:t.colGapT=e[0],t.colGapR=t.colGapL=e[1],t.colGapB=e[2];break;case 4:t.colGapT=e[0],t.colGapR=e[1],t.colGapB=e[2],t.colGapL=e[3]}}}function f(t){this._config=t,this._currentAjax=null,this._id=x++,this._boxes=[],this._frames={loaded:{},cur:0,max:0,min:0},this.init()}t("common/showLog");var u=t("component/shareTmp"),h=document,m=window,d=$(h),p=$(m),g=p.height(),_=$("<div></div>"),x=1,v=!1,y=".",T="down",E="up",L=!1,F=!0,w="waterfall-optimise-show",G="waterfall-optimise-hide",b=function(){return F},k="waterfall-container",H="waterfall-box",N="NORMAL",C="REVERSE",O="$$AddExtraStyle",R={NORMAL:N,REVERSE:C,SHOW:w,HIDE:G,FORCE_CHECK:"waterfall-force-check",EVENT_CLEAR_BACKUP:"waterfall-clear-backup"},S=g/2,I="scroll.waterfall",D="touchmove.waterfall",A="touchend.waterfall",M=1e3,B=6,j=0,P={el:".goods-wall",tmpl:"posterWall",type:"get",dataType:"json",data:{offset:0,frame:0,trace:0,limit:10,endId:0},dataName:"tInfo",layoutDirection:N,colGap:8,hasSideGap:!1,isEqualHeight:!1,canFetch:r,dataHandler:o,dataFilter:a,onBeforeFetch:b,onFetchStart:b,onFetchFinished:b,onFetchSuccess:b,onFetchError:b,onLayoutFinished:b,onDataEmpty:b,optimise:null},W=i(function(t,e){return t.max-e.max}),V=i(function(t,e){return e.max-t.max}),q=i(function(t,e){return e.min-t.min}),K=[],U=0,z=0,J=function(){return m.console?function(t){console.log(t)}:b}();!function(){if(!m[O]){m[O]=!0;var t=$('<style id="waterfall-optimise-style">.'+w+"{display:block;}."+G+"{display:none;}."+k+"{position:relative;}."+H+"{position:absolute;}</style>").appendTo("head");try{t.append(h.createTextNode(""))}catch(e){}}}(),f.prototype={constructor:f,init:function(){var t,e,i,n,o,a,r=this._config,s=r.colNum,f=r.hasSideGap,u=0,h=0,m=0;if(n=this.$el=r.$el=$(r.el),1!==n.length)throw Error("el 参数指定的 DOM 元素"+(n.length?"存在多个":"不存在")+", 请仔细检查 el 值。");if(n.addClass(k),this._cols=o=[],this._colsHistory=[],r.initTopOffset=n.offset().top,r.isFirstFrame=!0,c(r)(),l(r),t=r.colGapL,e=r.colGapR,i=e,f&&(h=2*t),!s||s<=0)throw Error("请传入 colNum");for(a=r.colWidth=Math.floor((n.width()-h-(s-1)*i)/s);u<s;u++)0==u?m=f?t:0:m+=a+i,o.push({min:0,max:0,left:m,frame:0});(r.useOptimise=!!r.optimiseFn)&&(this.bindTouchmoveEvent(),r.optimiseFn.initRange(s))},bindTouchmoveEvent:function(){var t,e,i,n=this,o=n._config,a="."+n._id;t=o.touchMoveEventName=D+a,e=o.touchEndEventName=A+a,d.on(t,function(){o.hasMoved=!0,d.triggerHandler(e)}).on(e,function(){!n._isLock&&o.hasMoved&&o.optimiseFn.optimise(n._boxes,p.scrollTop()-o.initTopOffset),o.hasMoved=!1}),p.on(I,function(){clearTimeout(i),i=setTimeout(function(){o.optimiseFn.optimise(n._boxes,p.scrollTop()-o.initTopOffset)},30)})},fetch:function(t){function e(t,e){a.onFetchFinished.call(o,t,e),o._isLoading=!1}function i(t){var e=o._frames,i=r.frame,n=t;a.rawData=n,t=a.dataFilter.call(o,t),o._isLock||t&&t.length||(o.lock(),a.onDataEmpty.call(o,a)),!o._isLock&&n&&n.data&&n.data.endId&&(n.data.endId===-1?(o.lock(),a.onDataEmpty.call(o,a)):r.endId=n.data.endId),a.onFetchSuccess.call(o,t,a),a.dataHandler.call(o,t,a),e.loaded[r.frame]=1,e.max<i&&(e.max=i),e.min>i&&(e.min=i),a.layoutDirection==N?r.frame++:r.frame--,r.trace=t?t.trace||0:0}function n(t,e,i){o._isLoading=!1,a.onFetchError.call(o,i,e)}var o=this,a=o._config,r=a.data;if(!o._isLoading)return o._isLoading=!0,a.onBeforeFetch.call(o,a)===L?void(o._isLoading=!1):(o._config.onFetchStart.call(o,a),this.isFrameLoaded(a.data.frame)?void(o._isLoading=!1):t?void setTimeout(function(){e(null,200),i(t)},0):void(this._currentAjax=$.ajax({type:a.type,dataType:a.dataType,data:r,url:a.url,success:i,error:n,complete:e})))},start:function(t){return this.fetch(t),this},lock:function(){return this._isLock=!0,this},isLoading:function(){return this._isLoading},getColsInfo:function(){return $.extend(!0,[],this._cols)},getColsHistoryInfo:function(){return $.extend(!0,[],this._colsHistory)},setColsHistoryInfo:function(t){return this._colsHistory=$.extend(!0,[],t),this},setColsInfo:function(t){return t&&t.length&&(this._cols=$.extend(!0,[],t)),this},getParam:function(t){return this._config[t]},updateParam:function(t,e){return this._config[t]=e,this},increaseDataParam:function(t){var e=this._config.data,i=+e[t];isNaN(i)?e[t]=0:e[t]=i+1},getDataByPath:n,updateLayoutDirection:function(t){if(!(t in R))throw Error(t+" is not a valid direction.");return this._config.layoutDirection=t,this},findLowestCol:function(){return q(this._cols)},findHighestCol:function(){return V(this._cols)},isFrameLoaded:function(t){return!!this._frames.loaded[t]},getCurrentFrame:function(){return this._config.data.frame},unlock:function(){return this._isLock=!1,this},destroy:function(){for(var t=U;t--;)K[t]._id===this._id&&(this._currentAjax&&(this._currentAjax.abort(),this._currentAjax=null),K.splice(t,1),U--)},resetCurTop:function(){return this._boxes._curTop=-9999,this},triggerScroll:function(t){return p.triggerHandler(I,[t||T]),this}},p.on(I,function(t,e){var i,n,o;U&&(n=p.scrollTop(),n||v?v=!1:(v=!0,clearTimeout(j),j=setTimeout(function(){o=!0,p.trigger(I)},10)),i=e==T||e!=E&&n>=z,z=n,K.forEach(function(t){t._isLock||t._config.canFetch.call(t,n,i)===F&&(t.fetch(),o&&t.resetCurTop())}))}),e.CONS=R,e.init=function(t){var e,i,n,o,a;if(t=$.extend(!0,{_totalIndex:0},P,t),"string"==typeof t.dataName&&(t._dataName=t.dataName.split(".")),i=t.plugins){if(Array.isArray(i)&&(o=i.some(function(t,e){return t.takeOver&&(a=e,1)})))return n=t.plugins.splice(a,1)[0],n.init(t);if(i.takeOver)return delete t.plugins,i.init(t)}return K.push(e=new f(t)),U++,i&&i.forEach(function(t){t.init(e)}),e}});;fml.define("page/search/catalog",["component/waterfall","component/exposure"],function(i,e){"use strict";function s(i,e,s){i=decodeURIComponent(i);var o=i.indexOf("?"),a=i.indexOf("page"),n=i.indexOf("cpc_offset");if(o>0){if(i.indexOf(s)>0||a||n){var r=i.slice(o+1),c=t(r),l="";c[s]=e,c.page||(c.page=1),c.cpc_offset||(c.cpc_offset=0);for(var h in c){var d;"object"==typeof c[h]?d=JSON.stringify(c[h]):"string"==typeof c[h]?d="page"==h?1:"cpc_offset"==h?0:c[h]:"page"==h?d=1:"cpc_offset"==h&&(d=0),l+=h+"="+d+"&"}return k+"?"+l.substring(0,l.length-1)}return i+"&"+s+"="+e+"&page=1"}return i+"?"+s+"="+e+"&page=1"}function t(i){var e=i.split("&"),s={};return $(e).each(function(i,e){var t=e.split("=");s[t[0]]=t[1]}),s}function o(i,e){try{var s={url:location.href,refer:document.referrer};e=$.extend({},e,s),logger.log(i,e)}catch(t){}}function a(){l.css({height:"40px"}),g.hide(),h.find(".mulChoice").show().removeClass("ismulChoice"),h.find(".choiceBox").hide(),h.find(".moreDesc").html("更多")}i("component/waterfall");i("component/exposure");var n=($(".userchoice"),$(".userchoice span"),$(".userchoiceWrap")),r=($(".styleTitle"),$(".styleName")),c=$(".styleNameWrap"),l=$(".styleCatalog"),h=$(".styleContainer"),d=$(".choice"),p=($(".styleName span"),$(".mulChoice")),f=$(".more"),m=$(".orderWrap"),u=$(".checkBoxWrap"),g=$(".btnWrap"),v=$(".btnNo"),C=$(".btnSure"),b=$(".filter"),w=$(".filterInfo"),x=$(".sure"),y=$(".userContain"),k=y.data("link"),D=($(".fashion"),$(".pageNav"));fml.vars.ppath?fml.vars.ppath=JSON.parse(fml.vars.ppath):fml.vars.ppath={},c.each(function(i){var e=$(this),s=e.siblings(".more");e.height()>40&&s.show()}),d.on("mouseover mouseout",".userchoice",function(i){"mouseover"==i.type?$(this).css({border:"1px solid #FF3168"}):"mouseout"==i.type&&$(this).css({border:"1px solid #DDDDDD"})}),n.on("click",".close",function(){var i=$(this),e=i.data("catepropnameid");delete fml.vars.ppath[e],$(this).parent(".userchoice").remove(),window.location.href=s(window.location.href,JSON.stringify(fml.vars.ppath),"ppath")}),r.on("click",function(){var i=$(this),e=i.parents(".styleNameWrap"),t=i.parents(".styleCatalog"),o=t.find(".btnSure"),a=l.find(".styleTitle"),n=(e.find(".activeChoiceBox"),i.html(),a.html(),e.siblings(".mulChoice").hasClass("ismulChoice")),r=e.siblings(".styleTitle").data("catepropnameid"),c=i.data("catepropid"),h=e.attr("data-choice"),d=i.find(".choiceBox").hasClass("activeChoiceBox");n?(d?(h=h.replace(","+c,""),e.attr("data-choice",h),i.find(".choiceBox").removeClass("activeChoiceBox")):(h+=","+c,i.find(".choiceBox").addClass("activeChoiceBox"),e.attr("data-choice",h)),e.find(".activeChoiceBox").length>0?o.removeClass("btnOn"):0==e.find(".activeChoiceBox").length&&o.addClass("btnOn")):(fml.vars.ppath[r]=c.toString(),window.location.href=s(window.location.href,JSON.stringify(fml.vars.ppath),"ppath"))}),p.on("click",function(){var i=$(this),e=i.parents(".styleCatalog");a(),i.addClass("ismulChoice"),e.find(".choiceBox").show(),e.css("height","auto"),e.find(".moreDesc").html("收起"),i.parents(".styleContainer").siblings(".btnWrap").show(),i.css({display:"none"}),i.siblings(".more").addClass("shouqi")}),v.on("click",function(){var i=$(this),e=i.parents(".styleCatalog"),s=i.parents(".btnWrap").siblings(".styleContainer");s.find(".mulChoice").show().removeClass("ismulChoice"),s.find(".choiceBox").hide(),s.find(".moreDesc").html("更多"),e.css({height:"40px"})}),C.on("click",function(){var i=$(this),e=i.parents(".btnWrap").siblings(".styleContainer").find(".styleNameWrap"),t=e.data("choice"),o=t.substring(1,t.length).split(","),a=i.parents(".btnWrap").siblings(".styleContainer").find(".styleTitle").attr("data-catepropnameid");fml.vars.ppath[a]=o,i.hasClass("btnOn")||(window.location.href=s(window.location.href,JSON.stringify(fml.vars.ppath),"ppath"))}),f.on("click",function(){var i=$(this).hasClass("shouqi");a(),h.find(".moreDesc").html("更多"),0==i?($(this).addClass("shouqi"),$(this).find(".moreDesc").html("收起"),$(this).parents(".styleCatalog").css("height","auto"),$(this).siblings(".mulChoice").show(),$(this).siblings(".styleCatalog").find(".btnWrap").hide()):($(this).removeClass("shouqi"),$(this).find(".moreDesc").html("更多"),$(this).siblings(".styleNameWrap").find(".choiceBox").hide(),$(this).parents(".styleCatalog").css("height","40px"))}),b.on("mouseover mouseout",function(i){var e=$(this),s=e.find(".filterInfoWrap"),t=e.find(".filterName"),o=e.find(".line");"mouseover"==i.type?(e.css({"z-index":"100"}),o.width(e.width()-2+"px"),o.show(),s.show(),t.css({"border-bottom":"1px solid transparent"})):(e.css({"z-index":"0"}),o.hide(),t.css({border:"1px solid #DDDDDD"}),s.hide())}),w.on("click",function(){var i=$(this),e=i.parents(".filterInfoWrap").siblings(".filterName"),t=e.data("catepropnameid"),o=i.data("catepropid");fml.vars.ppath[t]=o.toString(),window.location.href=s(window.location.href,JSON.stringify(fml.vars.ppath),"ppath")}),w.on("mouseover mouseout",function(i){"mouseout"==i.type?$(this).css({color:"#666666"}):"mouseover"==i.type&&$(this).css({color:"#ff3366"})}),m.on("click",".fashion",function(){var i=$(this),e=window.location.href,t=i.data("sort");i.siblings().removeClass("on"),i.addClass("on"),i.siblings().css({border:"1px solid transparent"}),i.hasClass("left")?i.css({"border-left":"1px solid #E1E1E1"}):i.hasClass("right")?i.css({"border-right":"1px solid #E1E1E1"}):i.css({"border-left":"1px solid #E1E1E1","border-right":"1px solid #E1E1E1"}),i.hasClass("price")||(window.location.href=s(e,t,"sort"))}),$(".priceDesc").on("click","li",function(){var i=$(this),e=i.data("sort"),t=window.location.href;i.parents(".price").html(i.html()),window.location.href=s(t,e,"sort")}),x.on("click",function(){var i=$(this),e=i.siblings(".minPrice"),t=i.siblings(".maxPrice"),o=window.location.href,a="",n="";n=e.val()?s(o,e.val(),"minPrice"):s(o,"","minPrice"),a=t.val()?s(n,t.val(),"maxPrice"):s(n,"","maxPrice"),window.location.href=a}),u.on("click",".checkInfo",function(){var i=$(this),e=i.find("span");i.hasClass("isChecked")?(i.removeClass("isChecked"),e.css({"background-position":"0 0"})):(e.css({"background-position":"-14px 0"}),i.addClass("isChecked"))}),D.on("click","a",function(){var i=$(".product-ul"),e=i.data("catalog"),s=i.data("param"),t=i.data("sort");if("catalog"==e)var s={fcid:s,tabname:t};else if("goods"==e)var s={keyword:s,tabname:t};o("000815004",s)}),$(".product-list").scrollLoading({indexs:"data-list",acms:"data-acms",iids:"data-iids",cpcs:"data-cpcs",eventid:[70004,70001,70015,70011],acm_num:[25,5],best:".cpcs"})});;fml.define("base",["common/polyfill","common/assert","common/topbar","common/search","common/nav","common/biu","lib/logger","lib/trace","common/user"],function(o,m){"use strict";o("common/polyfill"),o("common/assert"),o("common/topbar"),o("common/search"),o("common/nav"),o("common/biu"),o("lib/logger"),o("lib/trace"),o("common/user")});;